{% extends 'base.html' %}
{% load static %}
{% load humanize %}

{% block content %}
<section class="bg-gray-50 py-16 px-4 sm:px-8 pt-28">
  <div class="max-w-7xl mx-auto">
    <h2 class="text-4xl font-extrabold mb-12 text-center text-gray-800">همه محصولات</h2>

    <!-- فیلتر برندها - دقیقاً مشابه صفحه اصلی -->
    <div class="flex flex-wrap justify-center gap-3 mb-12">
      <a href="{% url 'products:products' %}"
         class="px-5 py-3 rounded-lg border border-blue-600 text-sm font-medium transition-all duration-300
                {% if not selected_brand_slug %}bg-blue-600 text-white shadow-md{% else %}text-blue-600 hover:bg-blue-600 hover:text-white{% endif %}">
        همه برندها
      </a>
      {% for brand in brands %}
        <a href="{% url 'products:product_category' brand.slug %}"
           class="px-5 py-3 rounded-lg border border-blue-600 text-sm font-medium transition-all duration-300
                  {% if brand.slug == selected_brand_slug %}bg-blue-600 text-white shadow-md{% else %}text-blue-600 hover:bg-blue-600 hover:text-white{% endif %}">
          {{ brand.name }}
        </a>
      {% endfor %}
    </div>

    <!-- کارت‌های محصولات - دقیقاً مشابه صفحه اصلی -->
    <div class="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-8">
      {% for product in products %}
        <div class="bg-white rounded-xl shadow-lg overflow-hidden transition-transform duration-300 hover:scale-105 flex flex-col h-full">

          <!-- تصویر محصول -->
          <div class="w-full h-48 overflow-hidden">
            <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-full h-full object-cover transition-transform duration-500 hover:scale-110">
          </div>

          <!-- محتوای کارت -->
          <div class="p-6 flex-1 flex flex-col">
            <!-- نام محصول و برند -->
            <div class="mb-4">
              <h3 class="text-xl font-bold text-gray-800 mb-1">{{ product.name }}</h3>
              <p class="text-gray-600 text-sm">{{ product.brand.name }}</p>
            </div>

            <!-- آیکن‌های قطعات -->
            <div class="flex justify-between items-center mb-4 px-2 py-3 bg-gray-50 rounded-lg">
              <div class="flex flex-col items-center w-1/3 px-1">
                <div class="bg-blue-100 p-2 rounded-full mb-2">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 text-blue-600">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 3v1.5M4.5 8.25H3m18 0h-1.5M4.5 12H3m18 0h-1.5m-15 3.75H3m18 0h-1.5M8.25 19.5V21M12 3v1.5m0 15V21m3.75-18v1.5m0 15V21m-9-1.5h10.5a2.25 2.25 0 0 0 2.25-2.25V6.75a2.25 2.25 0 0 0-2.25-2.25H6.75A2.25 2.25 0 0 0 4.5 6.75v10.5a2.25 2.25 0 0 0 2.25 2.25Zm.75-12h9v9h-9v-9Z" />
                  </svg>
                </div>
                <span class="text-xs text-center text-gray-600 leading-tight truncate w-full">
                  {{ product.product_specs.processor_brand }} {{ product.product_specs.processor_model }}
                </span>
              </div>

              <div class="flex flex-col items-center w-1/3 px-1">
                <div class="bg-blue-100 p-2 rounded-full mb-2">
                  <svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="size-5 text-blue-600">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M9 17.25v1.007a3 3 0 0 1-.879 2.122L7.5 21h9l-.621-.621A3 3 0 0 1 15 18.257V17.25m6-12V15a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 15V5.25m18 0A2.25 2.25 0 0 0 18.75 3H5.25A2.25 2.25 0 0 0 3 5.25m18 0V12a2.25 2.25 0 0 1-2.25 2.25H5.25A2.25 2.25 0 0 1 3 12V5.25" />
                  </svg>
                </div>
                <span class="text-xs text-center text-gray-600 truncate w-full">{{ product.product_specs.display }}</span>
              </div>

              <div class="flex flex-col items-center w-1/3 px-1">
                <div class="bg-blue-100 p-2 rounded-full mb-2">
                  <img src="https://uxwing.com/wp-content/themes/uxwing/download/computers-mobile-hardware/ram-memory-icon.png" alt="رم" class="w-5 h-5">
                </div>
                <span class="text-xs text-center text-gray-600 truncate w-full">{{ product.product_specs.ram }}</span>
              </div>
            </div>

            <!-- اطلاعات محصول -->
            <div class="space-y-2 mb-4 flex-1">
              <div class="flex justify-between items-center">
                <p class="text-sm text-gray-600">وضعیت:</p>
                <p class="text-sm font-medium text-gray-800">{{ product.get_condition_display }}</p>
              </div>

              <div class="flex justify-between items-center">
                <p class="text-sm text-gray-600">درجه تمیزی:</p>
                <p class="text-sm font-medium text-gray-800">{{ product.get_cleanliness_grade_display }}</p>
              </div>

              <div class="flex justify-between items-center">
                <p class="text-sm text-gray-600">تاریخ عرضه:</p>
                <p class="text-sm font-medium text-gray-800">{{ product.release_date|date:"Y/m/d" }}</p>
              </div>

              <div class="flex justify-between items-center">
                <p class="text-sm text-gray-600">موجودی:</p>
                <p class="{% if product.available %}text-green-600 font-semibold{% else %}text-red-600 font-semibold{% endif %}">
                  {% if product.available %}موجود{% else %}ناموجود{% endif %}
                </p>
              </div>
            </div>

            <!-- قیمت و دکمه -->
            <div class="flex justify-between items-center mt-auto pt-4 border-t border-gray-200">
              <span class="text-lg font-bold text-gray-800">{{ product.price|floatformat:0|intcomma }} تومان</span>
              <a href="{% url 'products:product_detail' product.id %}"
                 class="bg-red-600 text-white px-4 py-2 rounded-lg  hover:bg-red-700 transition">
                مشاهده جزئیات
              </a>
            </div>
          </div>
        </div>
      {% empty %}
        <div class="col-span-full text-center py-12">
          <div class="bg-white rounded-xl shadow-lg p-8 max-w-md mx-auto">
            <svg xmlns="http://www.w3.org/2000/svg" class="h-16 w-16 mx-auto text-gray-400 mb-4" fill="none" viewBox="0 0 24 24" stroke="currentColor">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9.172 16.172a4 4 0 015.656 0M9 10h.01M15 10h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
            </svg>
            <p class="text-xl text-gray-600">هیچ محصولی برای نمایش وجود ندارد.</p>
          </div>
        </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endblock %}